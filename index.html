<script>
  const btn = document.getElementById("pressButton");
  const output = document.getElementById("output");

  btn.addEventListener("click", async () => {
    btn.disabled = true;
    btn.textContent = "Unlocking...";
    btn.classList.remove("success", "error");
    output.textContent = "Sending commandâ€¦";

    try {
      const response = await fetch(
        "https://white-salad-42a2.hpprpqksfd.workers.dev/",
        {
          method: "POST"
        }
      );

      const data = await response.json();
      output.textContent = JSON.stringify(data, null, 2);

      if (data.message === "success") {
        btn.textContent = "Unlocked!";
        btn.classList.add("success");
      } else {
        btn.textContent = "Error!";
        btn.classList.add("error");
      }

    } catch (err) {
      output.textContent = `Error:\n${err.message}`;
      btn.textContent = "Error!";
      btn.classList.add("error");
    } finally {
      setTimeout(() => {
        btn.disabled = false;
        btn.textContent = "Unlock";
        btn.classList.remove("success", "error");
      }, 3000);
    }
  });
</script>
